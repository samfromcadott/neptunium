!function(e){var t={};function o(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},o.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t){function o(e,t){var o=$('<div class="wrapper"></div>'),n=$("<input />",{class:"number-input",type:"number",value:e.values[t.value],change:function(){e.values[t.value]=parseFloat($(this).val(),10)}});return"number"==typeof t.min&&n.attr("min",t.min),"number"==typeof t.max&&n.attr("max",t.max),"number"==typeof t.step&&n.attr("step",t.step),n.data("node",e.id),n.data("value",t.value),n.appendTo(o),$('<span class="label">'+t.label+"</span>").prependTo(o),o}function n(e,t){var o=$('<div class="wrapper"></div>'),n=$("<select />",{class:"dropdown-input",change:function(){e.values[t.value]=$(this).val()}});n.appendTo(o);for(var a=0;a<t.options.length;a++)n.append('<option value="'+t.options[a].value+'">'+t.options[a].label+"</option>");return n.val(e.values[t.value]),$('<span class="label">'+t.label+"</span>").prependTo(o),o}function a(e,t,o){var n=$("<div />",{class:"bus-wrapper"}),a=$("<span />",{class:"bus-label",text:t.label}),s=$("<div />",{class:"bus"});return"Input Note"==e.type?s.data("node","Input Note"):"Mixer"==e.type?s.data("node","mixer"):s.data("node",e.id),"out"==o?(s.addClass("out"),s.on("mousedown",p)):"in"==o&&s.addClass("in"),n.append(s),n.append(a),n}for(var s in nodeTypes)nodeTypes.hasOwnProperty(s)&&$("#tool-list").append('<li class="tool-item">'+s+"</li>");$(".tool-item").mousedown(function(e){if(1==e.which){e.preventDefault();var t=$(this).text();$(document).one("mouseup",function(e){var s={x:e.offsetX,y:e.offsetY},r=addNode(t),p=function(e){var t=$("<div />",{class:"node"}),s=$("<div />",{class:"node-bus"}),r=$("<div />",{class:"bus-in-wrapper"}).appendTo(s),i=$("<div />",{class:"bus-out-wrapper"}).appendTo(s),d=$("<div />",{class:"node-control"});for(var p in nodeTypes[e.type].ui)if(nodeTypes[e.type].ui.hasOwnProperty(p)){var u=nodeTypes[e.type].ui[p];"title"==u.type?t.prepend('<span class="title">'+u.text+"</span>"):"number"==u.type?o(e,u).appendTo(d):"dropdown"==u.type?n(e,u).appendTo(d):"bus-in"==u.type?a(e,u,"in").appendTo(r):"bus-out"==u.type&&a(e,u,"out").appendTo(i)}return t.css(nodeTypes[e.type].css),t.append(s),t.append(d),t}(r);p.css({top:s.y+"px",left:s.x+"px"}),r.position={top:s.y,left:s.x},p.appendTo("#background-grid"),p.draggable({cancel:".node-control, .node-bus",drag:function(){!function(){for(currentLine of i){var e=d(currentLine.startDiv),t=d(currentLine.endDiv);currentLine.vector.attr({x1:e.x,y1:e.y,x2:t.x,y2:t.y})}}(),r.position=$(this).position()},start:function(){p.css({"box-shadow":"6px 6px black"})},stop:function(){p.css({"box-shadow":"3px 3px black"})}})})}}),$("#background-grid").draggable({cancel:".node"});var r=SVG("drawing"),i=[];function d(e){return{x:e.offset().left-$("#background-grid").offset().left+e.width()/2,y:e.offset().top-$("#background-grid").offset().top+e.height()/2}}var p=function(e){if(1==e.which){e.preventDefault();var t=$(e.target),o=new function(e){this.startDiv=e,this.startPos=d(e),this.endPos=this.startPos,this.vector=r.line(this.startPos.x,this.startPos.y,this.endPos.x,this.endPos.y).stroke({width:10,color:"#"+(16777215*Math.random()<<0).toString(16),linecap:"round"}).addClass("bus-vector"),this.connectBusses=function(e,t){var o,n;o="Input Note"==e.data("node")?inputNote:nodeTree[e.data("node")],t.is(".bus, .in")?n=t.data("node"):t.is(".number-input")&&(n={node:t.data("node"),value:t.data("value")}),o.target.push(n),this.endDiv=t;var a=d(t);this.vector.attr({x2:a.x,y2:a.y})},this.dragline=function(e){this.vector.attr({x2:e.offsetX,y2:e.offsetY})},i[i.length]=this}(t);$(document).mousemove(function(e){o.vector.attr({x2:e.pageX-$("#background-grid").offset().left,y2:e.pageY-$("#background-grid").offset().top})}),$(document).one("mouseup",function(e){var n=$(e.target);$(document).off("mousemove"),n.is(".bus, .in")&&n.data("node")!=t.data("node")?o.connectBusses(t,n):n.is(".number-input")&&n.data("node")!=t.data("node")?o.connectBusses(t,n):(o.vector.remove(),delete o,i.pop())})}},u=!1;$("#hide-keyboard").click(()=>{0==u?(u=!0,$("#keyboard").hide(),$("#hide-keyboard").text("^")):1==u&&(u=!1,$("#keyboard").show(),$("#hide-keyboard").text("v"))});var c=new QwertyHancock({id:"keyboard",width:1e3,height:100,octaves:3,startNote:"A2",whiteNotesColour:"white",blackNotesColour:"black",hoverColour:"#f3e939"});c.keyDown=function(e,t){playNote(t,1)},c.keyUp=function(e,t){stopNote(t)}}]);